---
# renovate: datasource=github-tags depName=pre-commit/pre-commit-hooks
#
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks

default_install_hook_types:
  - pre-commit
  - post-checkout
  - post-merge
  - post-rewrite
  {%- if conventional_commits %}
  - pre-push
  - commit-msg
  {%- endif %}

default_stages:
  - pre-commit

exclude: |
  (?x)^(
    ^.*(copier-answers\.ya?ml)$
    ^.*\.rej$
  )$

repos:
  - repo: local
    hooks:
      - id: forbid-yml
        name: Forbid .yml file extensions (use .yaml)
        entry: YAML file extensions must be .yaml
        language: fail
        files: \.yml$
        exclude: |
          (?x)^(
            ^.*(copier-answers\.ya?ml)$
          )$
      - id: forbid-rej
        name: Forbid .rej file extensions from `copier update`
        entry: Forbid .rej file extensions from `copier update`
        language: fail
        files: \.rej$
  # renovate: datasource=github-tags depName=pre-commit/pre-commit-hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: "v4.6.0"
    hooks:
      - id: check-added-large-files
        args: [--maxkb=500000]
        stages: [pre-commit]
      - id: check-case-conflict
        stages: [pre-commit]
      - id: check-merge-conflict
        stages: [pre-commit]
      - id: check-ast
        stages: [pre-commit]
      - id: check-json
        stages: [pre-commit]
      - id: check-toml
        stages: [pre-commit]
      - id: check-yaml
        stages: [pre-commit]
      - id: detect-private-key
        stages: [pre-commit]
      - id: end-of-file-fixer
        stages: [pre-commit]
      - id: mixed-line-ending
        stages: [pre-commit]
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]
        stages: [pre-commit]
  # renovate: datasource=github-tags depName=Lucas-C/pre-commit-hooks
  - repo: https://github.com/Lucas-C/pre-commit-hooks
    rev: "v1.5.5"
    hooks:
      - id: remove-crlf
        stages: [pre-commit]
      # - id: remove-tabs
      #   stages: [pre-commit]
  # renovate: datasource=github-tags depName=sirosen/texthooks
  - repo: https://github.com/sirosen/texthooks
    rev: "0.6.6"
    hooks:
      - id: fix-smartquotes
        stages: [pre-commit]
      - id: fix-ligatures
        stages: [pre-commit]
  # renovate: datasource=github-tags depName=zricethezav/gitleaks
  - repo: https://github.com/zricethezav/gitleaks
    rev: "v8.18.2"
    hooks:
      - id: gitleaks
  {% if conventional_commits -%}
  - repo: https://github.com/commitizen-tools/commitizen
    rev: v4.8.2
    hooks:
    - id: commitizen
      {%- if cz_gitmoji %}
      {%- if repository_provider == 'github' %}
      # needed by Renovate to support additional dependencies
      # see https://docs.renovatebot.com/modules/manager/pre-commit/
      language: python
      {%- endif %}
      additional_dependencies:
        - cz-conventional-gitmoji
      {%- endif %}
      stages:
      - commit-msg
  {%- endif %}{%- if editorconfig %}
  # renovate: datasource=github-tags depName=editorconfig-checker/editorconfig-checker.python
  - repo: https://github.com/editorconfig-checker/editorconfig-checker.python
    rev: "2.7.3"
    hooks:
      - id: editorconfig-checker
        name: Check editorconfig compliance
        exclude: |
          (?x)^(
            # these file types may have nonstandard indents
            ^(LICENSE)$ |
            ^.*(\.md)$ |
            ^.*(\.rst)$
          )$
        stages: [pre-commit]
  {%- endif %}{% if exif-stripper %}
  # renovate: datasource=github-tags depName=stefmolin/exif-stripper
  - repo: https://github.com/stefmolin/exif-stripper
    rev: 0.5.0
    hooks:
      - id: strip-exif
        name: Strip exif metadata from images
        stages: [pre-commit]
  {%- endif %}{% if docker %}
  - repo: local
    hooks:
      - id: hadolint
        name: Lint Dockerfiles
        language: system
        entry: hadolint
        types: ["dockerfile"]
        stages: [pre-commit]
  {%- endif %}{% if markdown %}
  # renovate: datasource=github-tags depName=igorshubovych/markdownlint-cli
  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: "v0.40.0"
    hooks:
      - id: markdownlint
        name: Lint markdown files
        args:
          - --config=.markdownlint.yaml
          - --fix
        stages: [pre-commit]
  {%- endif %}{% if jupyter %}
  # renovate: datasource=github-tags depName=kynan/nbstripout
  - repo: https://github.com/kynan/nbstripout
    rev: 0.8.0
    hooks:
      - id: nbstripout
        name: Strip metadata and outputs from ipynb files
        stages: [pre-commit]
  {%- endif %}{% if biome %}
  # renovate: datasource=github-tags depName=biomejs/pre-commit
  - repo: https://github.com/biomejs/pre-commit
    rev: v0.6.1
    hooks:
      - id: biome-check
        name: Lint with Biome
        args: [--fix]
        stages: [pre-commit]
  {%- endif %}{% if prettier %}
  - repo: local
    hooks:
      - id: prettier
        name: Format with Prettier
        language: system
        entry: prettier
        args:
          - --write
          - --ignore-unknown
          - --no-error-on-unmatched-pattern
          # - "--ignore-path '**/*.md'"
          # - "--ignore-path '**/*.y*ml'"
        stages: [pre-commit]
  {%- endif %}{% if python %}
  # renovate: datasource=github-tags depName=charliermarsh/ruff-pre-commit
  - repo: https://github.com/charliermarsh/ruff-pre-commit
    rev: "v0.4.4"
    hooks:
      - id: ruff
        name: Lint and Format with Ruff
        args: [--fix]
        stages: [pre-commit]
  {%- endif %}{% if shell %}
  - repo: local
    hooks:
      - id: shellcheck
        name: Lint shell scripts
        language: system
        entry: shellcheck
        types: ["shell"]
        exclude: "^.*zsh$" # ignore '*.zsh" scripts'
        stages: [pre-commit]
  # renovate: datasource=github-tags depName=scop/pre-commit-shfmt versioning=loose
  - repo: https://github.com/scop/pre-commit-shfmt
    rev: "v3.8.0-1"
    hooks:
      - id: shfmt
        name: Format shell scripts
        args:
          - -i
          - "2"
          - -ci
          - -bn
        stages: [pre-commit]
  {%- endif %}{% if typos %}
  ### NOTE: ".typos.toml" may be required to have _already been committed_
  ### in order for typos pre-commit hook to read it.
  ### In this case, comment out this block until ".typos.toml" has been committed successfully
  # renovate: datasource=github-tags depName=crate-ci/typos
  - repo: https://github.com/crate-ci/typos
    rev: "v1.22.2"
    hooks:
      - id: typos
        name: Spellcheck with Typos
        args: ["--config", ".typos.toml"]
        exclude: |
          (?x)^(
            ^.*(\.typos\.toml)$ |
            ^.*(\.git.*)$
          )$
        stages: [pre-commit]
  {%- endif %}{% if yaml %}
  # renovate: datasource=github-tags depName=adrienverge/yamllint
  - repo: https://github.com/adrienverge/yamllint
    rev: "v1.37.0"
    hooks:
      - id: yamllint
        name: Lint yaml files
        args: [-c=.yamllint.yaml]
        stages: [pre-commit]
  {%- endif %}
